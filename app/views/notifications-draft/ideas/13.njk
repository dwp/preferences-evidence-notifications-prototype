{% extends "layouts/main.html" %}

{% block pageTitle %}
My notifications
{% endblock %}


{% block beforeContent %}

{% include "preferences/breadcrumbs/customer-view/when-we-speak-to-you.html" %}

{% endblock %}

{% block content %}

<div class="govuk-width-container">
  <main class="govuk-main-wrapper">

    <div class="govuk-grid-row">

      <div class="govuk-grid-column-two-thirds">

        <h1 class="govuk-heading-l">Your notifications</h1>

        <p>This service does not show notifications for Universal Credit or Scottish devolved benefits.</p>

        <p>You have unread notifications&nbsp<span id="notifications" class="moj-notification-badge">2</span></p>

        <div class="govuk-!-padding-bottom-2"></div>
      
      </div>

    </div>

    <div class="govuk-grid-row">

      <div class="govuk-grid-column-full sidebar">

        <details class="govuk-details">
          <summary class="govuk-details__summary">
            <span class="govuk-details__summary-text">
              Show filters
            </span>
          </summary>
          <div class="govuk-details">
  
            <div class="govuk-!-padding-bottom-4"></div>

<body>
  <form id="filter-form">
  <div class="moj-filter cv-filter" style="background-color:#f3f2f1">
    <div class="moj-filter__content">
      <!-- filter options -->
      <div class="moj-filter__options">
      <fieldset class="govuk-fieldset">
          <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">Filters</legend>

          <div class="govuk-grid-row">
            <div class="govuk-grid-column-one-third sidebar">

              <div class="govuk-!-padding-bottom-2"></div>


          <!-- filter by read status -->

          <div class="govuk-form-group">
              <fieldset class="govuk-fieldset">
                <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">Status</legend>
                  <div class="govuk-radios">
                      <div class="govuk-radios__item">
                          <input class="govuk-radios__input" id="status-all" name="status" type="radio" value="all" checked>
                          <label class="govuk-label govuk-radios__label" for="status-all">All notifications (2)</label>
                      </div>
                      <div class="govuk-radios__item">
                          <input class="govuk-radios__input" id="status-read" name="status" type="radio" value="read">
                          <label class="govuk-label govuk-radios__label" for="status-read">Read (0)</label>
                      </div>
                      <div class="govuk-radios__item">
                          <input class="govuk-radios__input" id="status-unread" name="status" type="radio" value="unread">
                          <label class="govuk-label govuk-radios__label" for="status-unread">Unread (2)</label>
                      </div>
                  </div>
              </fieldset>
          </div>
          </div>


          <div class="govuk-grid-column-one-third leftside">
            <div class="govuk-!-padding-bottom-2"></div>

          <!-- filter by benefits -->
          <div class="govuk-form-group">
            <fieldset class="govuk-fieldset">
                <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">Sender</legend>
                <div class="govuk-checkboxes">
                    <div class="govuk-checkboxes__item">
                        <input class="govuk-checkboxes__input" id="benefit-three" name="benefit" type="checkbox" value="Department for Work and Pensions" checked data-name="Department for Work and Pensions">
                        <label class="govuk-label govuk-checkboxes__label" for="benefit-three">Department for Work and Pensions</label>
                  </div>
                  <div class="govuk-checkboxes__item">
                    <input class="govuk-checkboxes__input" id="benefit-four" name="benefit" type="checkbox" value="Employment Support Allowance (ESA)" checked data-name="Employment Support Allowance (ESA)">
                    <label class="govuk-label govuk-checkboxes__label" for="benefit-four">Employment Support Allowance (ESA)</label>
                </div>
            </fieldset>
        </div>
          </div>

              <!-- Start date picker -->

          <div class="govuk-grid-column-one-third leftside">
            <div class="govuk-!-padding-bottom-2"></div>

            <div class="govuk-form-group sidebar">

              <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">Date range</legend>

              <div class="govuk-!-padding-bottom-2"></div>

              <label class="govuk-label" for="start-date">From</label>
              <div class="govuk-date-input" id="start-date">
                  <div class="govuk-date-input__item">
                      <div class="govuk-form-group">
                          <label class="govuk-label govuk-date-input__label" for="start-date-day">Day</label>
                          <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="start-date-day" name="start-date-day" type="text" pattern="[0-9]*">
                      </div>
                  </div>
                  <div class="govuk-date-input__item">
                      <div class="govuk-form-group">
                          <label class="govuk-label govuk-date-input__label" for="start-date-month">Month</label>
                          <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="start-date-month" name="start-date-month" type="text" pattern="[0-9]*">
                      </div>
                  </div>
                  <div class="govuk-date-input__item">
                      <div class="govuk-form-group">
                          <label class="govuk-label govuk-date-input__label" for="start-date-year">Year</label>
                          <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="start-date-year" name="start-date-year" type="text" pattern="[0-9]*">
                      </div>
                  </div>
              </div>
          </div>

          <!-- End date picker -->

          <div class="govuk-form-group">
              <label class="govuk-label" for="end-date">To</label>
              <div class="govuk-date-input" id="end-date">
                  <div class="govuk-date-input__item">
                      <div class="govuk-form-group">
                          <label class="govuk-label govuk-date-input__label" for="end-date-day">Day</label>
                          <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="end-date-day" name="end-date-day" type="text" pattern="[0-9]*">
                      </div>
                  </div>
                  <div class="govuk-date-input__item">
                      <div class="govuk-form-group">
                          <label class="govuk-label govuk-date-input__label" for="end-date-month">Month</label>
                          <input class="govuk-input govuk-date-input__input govuk-input--width-2" id="end-date-month" name="end-date-month" type="text" pattern="[0-9]*">
                      </div>
                  </div>
                  <div class="govuk-date-input__item">
                      <div class="govuk-form-group">
                          <label class="govuk-label govuk-date-input__label" for="end-date-year">Year</label>
                          <input class="govuk-input govuk-date-input__input govuk-input--width-4" id="end-date-year" name="end-date-year" type="text" pattern="[0-9]*">
                      </div>
                  </div>
              </div>
          </div>

        </div>

    
        <!-- apply filter button -->


      </fieldset>

      <div class="centered-link">
      <a href="#" class="govuk-link" onclick="resetFilter()">Reset filter</a>
      </div>
    </form>

      <div class="govuk-!-padding-bottom-4"></div>

      <div style="width: 100%;">
        <button class="govuk-button" type="button" id="apply-filter" onclick="filterTable()">Apply filter</button>
      </div>
      </div>
      </div>
      </div>
  </form>

</div>

</div>
</div>

<table class="govuk-table">
  <thead class="govuk-table__head">
      <tr class="govuk-table__row">
          <th scope="col" class="govuk-table__header" style="padding-left:10px;">Date</th>
          <th scope="col" class="govuk-table__header">Sender</th>
          <th scope="col" class="govuk-table__header">Notification</th>
          <th scope="col" class="govuk-table__header" style="padding-right:10px;">Status</th>
      </tr>
  </thead>
  <tbody class="govuk-table__body" id="table-body">
    <tr class="govuk-table__row"  style="background-color:#f3f2f1">
      <th scope="row" class="govuk-table__header date-column" id="date-column">
      </th>
      <td class="govuk-table__cell" data-benefit="Department for Work and Pensions">Employment Support Allowance (ESA)</td>
      <td class="govuk-table__cell"><a href="messages/proof-of-benefit" class="govuk-link">Proof of Benefit letter</a>
        <td class="govuk-table__cell" style="padding-right:10px;" data-status="unread">
        <strong class="govuk-tag custom-unread-tag">
        Unread
      </strong>
    </td>
    </tr>
      <tr class="govuk-table__row"  style="background-color:#f3f2f1">
        <th scope="row" class="govuk-table__header date-column" id="date-column">
        </th>
        <td class="govuk-table__cell" data-benefit="Department for Work and Pensions">Department for Work and Pensions</td>
        <td class="govuk-table__cell"><a href="messages/round-2" class="govuk-link">About your notifications</a>
          <td class="govuk-table__cell" style="padding-right:10px;" data-status="unread">
          <strong class="govuk-tag custom-unread-tag">
          Unread
        </strong>
      </td>
      </tr>
  </tbody>
</table>

  <div class="govuk-!-padding-bottom-4"></div>


</div>

</div>

</main>
</div>

  <style>

    @media (max-width: 960px) { /* Adjust breakpoint as needed */
      .sidebar {
        width: 100%;
        margin-top: 20px; /* Adds spacing when stacked */
      }
      .leftside {
        width: 100%;
        margin-left: 40px; /* Adds spacing when stacked */
      }
    }
  
    .govuk-table__cell {
      padding-top: 18px;
      padding-bottom: 20px;
    }
  
    .govuk-table__header {
      padding-top: 18px;
      padding-bottom: 20px;
    }
  
    #apply-filter {
      width: 100%;
      display: block;
    }

    .centered-link {
      text-align: center;
      margin-top: 20px;
    }

    .date-column {
      padding-left: 10px;
    }

    .custom-unread-tag {
      background-color: #1d70b8;
      color: white;
    }

    .govuk-body-message {
       padding: 0;
    }

    .custom-padding .govuk-table__cell {
          padding-bottom: 0px;
        }

  </style>

<script>

document.addEventListener('DOMContentLoaded', (event) => {

const today = new Date ();
const formattedDate = today.toLocaleDateString('en-GB');

const dateColumns = document.querySelectorAll('.date-column');
dateColumns.forEach(column => {
  column.textContent = formattedDate;
  
});

// document.getElementById('date-column').textContent = formattedDate;

});


  function filterTable() {
      const status = document.querySelector('input[name="status"]:checked').value;
      const benefits = Array.from(document.querySelectorAll('input[name="benefit"]:checked')).map(cb => cb.value);
      const startDate = `${document.getElementById('start-date-year').value}-${document.getElementById('start-date-month').value}-${document.getElementById('start-date-day').value}`;
      const endDate = `${document.getElementById('end-date-year').value}-${document.getElementById('end-date-month').value}-${document.getElementById('end-date-day').value}`;

      const rows = document.querySelectorAll('#table-body tr');
      rows.forEach(row => {
          const date = row.querySelector('th').innerText;
          const benefit = row.querySelector('td:nth-child(2)').innerText;
          const rowStatus = row.querySelector('td:nth-child(4)').dataset.status;

          let showRow = true;

          if (status !== 'all' && rowStatus !== status) {
              showRow = false;
          }

          if (benefits.length > 0 && !benefits.includes(benefit)) {
              showRow = false;
          }

          const rowDate = new Date(date.split('/').reverse().join('-'));
          if (startDate && rowDate > new Date(startDate.split('/').reverse().join('-'))) {
              showRow = false;
          }

          if (endDate && rowDate < new Date(endDate.split('/').reverse().join('-'))) {
              showRow = false;
          }

          row.style.display = showRow ? '' : 'none';
      });
  }

  function resetFilter() {
      document.getElementById('filter-form').reset();
      filterTable();
  }
</script>
</body>

{% endblock %}